<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ç»™ä½ çš„ä¸€å°è¡¨ç™½ä¿¡</title>
  <meta name="description" content="è¿™æ˜¯ä¸ºä½ å®šåˆ¶çš„è¡¨ç™½é¡µé¢ â€” æœ‰éŸ³ä¹ã€é£˜èŠ±ç“£ã€æ‰“å­—æœºã€çƒŸèŠ±å’Œå¯†ç ä¿æŠ¤ã€‚" />
  <!-- å¾®ä¿¡/ç¤¾äº¤é¢„è§ˆ -->
  <meta property="og:title" content="ç»™ä½ çš„ä¸€å°è¡¨ç™½ä¿¡" />
  <meta property="og:description" content="ç‚¹å¼€çœ‹æƒŠå–œï¼Œæœ‰ä¸“å±éŸ³ä¹ä¸åŠ¨ç”»ã€‚" />
  <meta property="og:image" content="/images/preview.jpg" />
  <meta name="mobile-web-app-capable" content="yes">
  <style>
    /* Reset + åŸºç¡€ */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family: -apple-system,BlinkMacSystemFont,"Helvetica Neue",Segoe UI,Roboto,"PingFang SC","Hiragino Sans GB","Microsoft Yahei",arial}
    body{background:linear-gradient(180deg,#0b1020 0%,#17182a 60%);color:#fff;overflow:hidden}

    /* ä¸­å¿ƒå¡ç‰‡ */
    .wrap{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:20px}
    .card{width:100%;max-width:780px;background:linear-gradient(135deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));border-radius:18px;padding:28px;backdrop-filter: blur(6px);box-shadow:0 10px 40px rgba(2,8,23,0.6);position:relative;overflow:hidden}

    h1{font-size:28px;margin-bottom:6px;letter-spacing:1px}
    .subtitle{opacity:0.8;margin-bottom:18px}

    /* æ‰“å­—æœº */
    .typewriter{font-size:18px;line-height:1.6;min-height:88px}
    .cursor{display:inline-block;width:2px;height:1em;background:#ffccd5;margin-left:6px;vertical-align:middle;animation:blink 1s steps(2,end) infinite}
    @keyframes blink{50%{opacity:0}}

    /* æ§åˆ¶æŒ‰é’® */
    .controls{display:flex;gap:10px;margin-top:18px}
    .btn{padding:10px 14px;border-radius:10px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.04);cursor:pointer;font-weight:600}

    /* å¿ƒå½¢ */
    .heart{position:absolute;right:26px;top:20px;width:64px;height:64px;transform:scale(0.9);animation:beat 1s ease-in-out infinite}
    .heart:before,.heart:after{content:'';position:absolute;left:32px;top:0;width:32px;height:48px;background:#ff5a7a;border-radius:32px 32px 0 0;transform-origin:0 100%}
    .heart:after{left:0;transform:rotate(-45deg)}
    .heart:before{left:32px;transform:rotate(45deg)}
    @keyframes beat{0%,100%{transform:scale(0.9)}50%{transform:scale(1.05)}}

    /* é£˜èŠ±ç“£ */
    .petal{position:fixed;top:-10vh;left:50%;width:18px;height:18px;background:radial-gradient(circle at 30% 30%,#fff7f9 0,#ffb6c1 60%);opacity:0.9;border-radius:45%/55%;transform:rotate(20deg);pointer-events:none;z-index:6}

    /* çƒŸèŠ±ç”»å¸ƒ */
    #fireworks{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:3}

    /* å¯†ç æ¨¡æ€ */
    .overlay{position:fixed;inset:0;background:linear-gradient(180deg,rgba(2,6,23,0.6),rgba(2,6,23,0.85));display:flex;align-items:center;justify-content:center;z-index:20}
    .modal{background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));padding:26px;border-radius:12px;width:94%;max-width:420px;text-align:center}
    .modal input{width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;margin-top:12px}

    /* éŸ³ä¹æ§åˆ¶ */
    .music-btn{position:fixed;left:18px;bottom:18px;z-index:30;padding:10px 12px;border-radius:14px;background:rgba(0,0,0,0.35);border:1px solid rgba(255,255,255,0.06)}

    /* åˆ†äº«æç¤º */
    .share-tip{position:fixed;left:50%;transform:translateX(-50%);bottom:80px;background:rgba(0,0,0,0.6);padding:10px 14px;border-radius:999px;font-size:14px;z-index:30}

    /* å“åº” */
    @media(max-width:520px){h1{font-size:22px}.card{padding:18px}}
  </style>
</head>
<body>
  <div id="app" class="wrap">
    <div class="card">
      <div class="heart" title="â¤"></div>
      <h1 id="title">äº²çˆ±çš„ â€”â€”</h1>
      <div class="subtitle">ç‚¹ä¸‹æ–¹æŒ‰é’®ï¼Œå¼€å§‹å±äºæˆ‘ä»¬çš„æƒŠå–œ</div>
      <div class="typewriter" id="typewriter"></div>

      <div class="controls">
        <button class="btn" id="replay">é‡æ–°æ’­æ”¾æ‰“å­—</button>
        <button class="btn" id="fire">æ”¾çƒŸèŠ±</button>
        <button class="btn" id="share">åˆ†äº«ï¼ˆé•¿æŒ‰å¤åˆ¶é“¾æ¥ï¼‰</button>
      </div>

      <!-- å¯æ›¿æ¢å›¾ç‰‡/å¤´åƒå±•ç¤ºåŒº -->
      <div style="margin-top:18px;display:flex;gap:12px;align-items:center">
        <img id="avatar" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='86' height='86'><rect width='100%' height='100%' fill='%23ffdfe6' rx='12'/></svg>" alt="avatar" style="width:86px;height:86px;border-radius:14px;object-fit:cover;border:1px solid rgba(255,255,255,0.04)">
        <div style="flex:1">
          <div style="font-weight:700">[ä½ çš„åå­—]</div>
          <div style="opacity:0.75;font-size:14px;margin-top:6px">ç‰¹åˆ«ä¸ºä½ å‡†å¤‡çš„é¡µé¢ Â· è®°å¾—ç‚¹éŸ³ä¹ â˜º</div>
        </div>
      </div>

    </div>
  </div>

  <!-- çƒŸèŠ±ç”»å¸ƒ -->
  <canvas id="fireworks"></canvas>
  <!-- å¯†ç è¦†ç›–å±‚ï¼ˆåˆå§‹å¯ç”¨ï¼‰ -->
  <div id="overlay" class="overlay">
    <div class="modal">
      <h3>è¿™æ˜¯ç»™ä½ çš„å¯†è¯­</h3>
      <p style="opacity:0.8">è¾“å…¥å¯†ç æŸ¥çœ‹ï¼ˆé»˜è®¤å¯†ç ï¼š520ï¼‰</p>
      <input id="pwd" placeholder="è¾“å…¥å››ä½å¯†ç " maxlength="12" />
      <button id="unlock" class="btn" style="margin-top:12px">è§£é”å¹¶è¿›å…¥</button>
      <div style="margin-top:10px;font-size:12px;opacity:0.7">æ²¡æœ‰å¯†ç ï¼Ÿå‘é€æš—å·ç»™æˆ‘ï¼Œæˆ‘ä»¬ç§ä¸‹è¯´æ˜ ğŸ’Œ</div>
    </div>
  </div>

  <!-- éŸ³ä¹ï¼ˆæŠŠsrcæ›¿æ¢ä¸ºä½ ä¸Šä¼ çš„mp3é“¾æ¥ï¼‰ -->
  <audio id="bgm" loop preload="auto" src="https://cdn.jsdelivr.net/gh/terrytangyuan/samples/music-lovely.mp3"></audio>
  <button id="musicBtn" class="music-btn">æ’­æ”¾éŸ³ä¹ â–¶</button>
  <div id="shareTip" class="share-tip" style="display:none">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œå‘é€ç»™TAå§ï¼</div>

  <script>
    /***** é…ç½®åŒºï¼ˆè¯·æŒ‰éœ€ä¿®æ”¹ï¼‰ *****/
    const CONF = {
      receiverName: 'æœ€çˆ±çš„ä½ ', // å±•ç¤ºåœ¨æ ‡é¢˜
      avatar: '', // è‹¥ä¸ä¸ºç©ºï¼Œæ›¿æ¢å¤´åƒURL
      password: '520', // åˆå§‹æŸ¥çœ‹å¯†ç 
      typingLines: [
        'ç¬¬ä¸€æ¬¡è§åˆ°ä½ ï¼Œæˆ‘ä»¥ä¸ºåªæ˜¯é£æ™¯ï¼Œåæ¥æ‰çŸ¥é“ä½ æ˜¯æ•´ä¸ªä¸–ç•Œã€‚',
        'ä½ ç¬‘èµ·æ¥çš„æ ·å­ï¼Œæ˜¯æˆ‘æ¯å¤©éƒ½æƒ³çœ‹åˆ°çš„é˜³å…‰ã€‚',
        'æ„¿æ„å’Œæˆ‘ä¸€èµ·çœ‹æ—¥å‡ºï¼Œçœ‹å¤§é›¨ä¸­çš„è¡—é“ï¼Œçœ‹ç”µå½±åˆ°å‡Œæ™¨å—ï¼Ÿ',
        'æˆ‘å–œæ¬¢ä½ ï¼Œå¾ˆä¹…å¾ˆä¹…äº†ã€‚'
      ],
      musicAutoPlay: false // ç§»åŠ¨ç«¯æµè§ˆå™¨å¸¸ä¼šé˜»æ­¢è‡ªåŠ¨æ’­æ”¾ï¼Œä¿ç•™æ‰‹åŠ¨æŒ‰é’®
    }

    // åº”ç”¨é…ç½®
    document.getElementById('title').innerText = CONF.receiverName + 'ï¼Œä½ å¥½';
    if(CONF.avatar) document.getElementById('avatar').src = CONF.avatar;

    // å¯†ç è§£é”
    const overlay = document.getElementById('overlay');
    document.getElementById('unlock').addEventListener('click', ()=>{
      const v = document.getElementById('pwd').value.trim();
      if(v === CONF.password){ overlay.style.display='none'; startAll(); }
      else { alert('å¯†ç é”™è¯¯ï¼Œè¯•è¯•520å§ ğŸ˜‰'); }
    });

    // æ‰“å­—æœºæ•ˆæœ
    const typeEl = document.getElementById('typewriter');
    let typingIndex=0, charIndex=0;
    function typeOnce(lines,cb){
      if(typingIndex>=lines.length){ cb&&cb(); return }
      const line = lines[typingIndex];
      charIndex=0; typeEl.innerHTML='';
      const cur = document.createElement('div'); typeEl.appendChild(cur);
      const cdiv = document.createElement('span'); cur.appendChild(cdiv);
      const cursor = document.createElement('span'); cursor.className='cursor'; cur.appendChild(cursor);
      const t = setInterval(()=>{
        cdiv.innerText = line.slice(0, ++charIndex);
        if(charIndex>=line.length){ clearInterval(t); typingIndex++; setTimeout(()=>typeOnce(lines,cb),700) }
      }, 48);
    }
    document.getElementById('replay').addEventListener('click', ()=>{ typingIndex=0; typeOnce(CONF.typingLines); })

    // èƒŒæ™¯èŠ±ç“£éšæœºç”Ÿæˆ
    function spawnPetal(){
      const p = document.createElement('div'); p.className='petal';
      document.body.appendChild(p);
      const startX = Math.random()*100; p.style.left = startX+'%';
      const scale = 0.6 + Math.random()*0.9; p.style.transform = 'scale('+scale+') rotate('+Math.random()*360+'deg)';
      const duration = 8000 + Math.random()*9000;
      p.animate([
        {transform: p.style.transform, top:'-10vh', opacity:1},
        {transform: 'translateX('+((Math.random()-0.5)*40)+'vw) rotate('+ (Math.random()*720-360) +'deg)', top:'110vh', opacity:0.6}
      ],{duration:duration, easing:'linear'});
      setTimeout(()=>p.remove(), duration+200);
    }

    // å‘¨æœŸç”Ÿæˆ
    let petalTimer;
    function startPetals(){ petalTimer = setInterval(spawnPetal,420); }
    function stopPetals(){ clearInterval(petalTimer); }

    // èƒŒæ™¯éŸ³ä¹æ§åˆ¶
    const bgm = document.getElementById('bgm'); const musicBtn=document.getElementById('musicBtn');
    musicBtn.addEventListener('click', ()=>{
      if(bgm.paused){ bgm.play().catch(()=>{}); musicBtn.innerText='æš‚åœéŸ³ä¹ â¸' }
      else { bgm.pause(); musicBtn.innerText='æ’­æ”¾éŸ³ä¹ â–¶' }
    });

    // åˆ†äº«å¤åˆ¶é“¾æ¥ï¼ˆå¾®ä¿¡ç¯å¢ƒé‡Œé•¿æŒ‰ä¼šæ˜¾ç¤ºè½¬å‘ï¼‰
    document.getElementById('share').addEventListener('click', async ()=>{
      try{ await navigator.clipboard.writeText(location.href); const tip=document.getElementById('shareTip'); tip.style.display='block'; setTimeout(()=>tip.style.display='none',1800);}catch(e){alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é•¿æŒ‰é“¾æ¥å¤åˆ¶')}
    });

    // çƒŸèŠ±ï¼ˆç®€å•å®ç°ï¼‰
    const c = document.getElementById('fireworks'); const ctx = c.getContext('2d');
    function resizeCanvas(){c.width = innerWidth; c.height = innerHeight}
    addEventListener('resize', resizeCanvas); resizeCanvas();

    // çƒŸèŠ±ç²’å­ç³»ç»Ÿï¼ˆç®€åŒ–ï¼‰
    let particles=[];
    function spawnFirework(x,y){
      const power = 40 + Math.random()*60;
      const count = 20 + Math.floor(Math.random()*30);
      for(let i=0;i<count;i++){
        const ang = Math.random()*Math.PI*2; const speed = power*(0.2+Math.random()*0.9);
        particles.push({x,y,vx:Math.cos(ang)*speed,vy:Math.sin(ang)*speed,life:60+Math.random()*40,color:`hsl(${Math.floor(Math.random()*360)},80%,60%)`});
      }
    }
    function updateFireworks(){
      ctx.clearRect(0,0,c.width,c.height);
      for(let i=particles.length-1;i>=0;i--){
        const p=particles[i]; p.x+=p.vx*0.12; p.y+=p.vy*0.12; p.vy+=0.6; p.life--;
        ctx.globalAlpha = Math.max(0,p.life/80);
        ctx.fillStyle = p.color; ctx.beginPath(); ctx.arc(p.x,p.y, Math.max(1,p.life/12),0,Math.PI*2); ctx.fill();
        if(p.life<=0) particles.splice(i,1);
      }
      requestAnimationFrame(updateFireworks);
    }
    updateFireworks();
    document.getElementById('fire').addEventListener('click', ()=>{ spawnFirework(innerWidth*0.5, innerHeight*0.3); spawnFirework(innerWidth*0.3, innerHeight*0.5); spawnFirework(innerWidth*0.7, innerHeight*0.5); });

    // å¼€å§‹å…¨éƒ¨æ•ˆæœ
    function startAll(){ startPetals(); typingIndex=0; typeOnce(CONF.typingLines); if(CONF.musicAutoPlay) bgm.play().catch(()=>{}); }

    // é¡µé¢é¦–æ¬¡è½½å…¥ï¼šä¿æŒå¯†ç è¦†ç›–å±‚ï¼Œé™¤éå¯†ç ä¸ºç©º
    if(!CONF.password){ overlay.style.display='none'; startAll() }

    // è‡ªåŠ¨è§£é”ç¤ºä¾‹ï¼ˆæŒ‰å›è½¦ï¼‰
    document.getElementById('pwd').addEventListener('keydown', (e)=>{ if(e.key==='Enter') document.getElementById('unlock').click() })

    // ç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®å¯åŠ¨éŸ³ä¹ï¼ˆç§»åŠ¨ç«¯å‹å¥½å¯åŠ¨ï¼‰
    let oneTap = false; document.body.addEventListener('click', ()=>{ if(!oneTap){ oneTap=true; if(CONF.musicAutoPlay) bgm.play().catch(()=>{}); } },{once:true})

    // é¡µé¢åŠ è½½å®Œç®€å•è¿›åœºåŠ¨ç”»
    window.addEventListener('load', ()=>{ document.querySelector('.card').animate([{transform:'translateY(20px)',opacity:0},{transform:'translateY(0)',opacity:1}],{duration:700,easing:'cubic-bezier(.2,.9,.3,1)'}); });

    // æ–¹ä¾¿å¼€å‘è€…ï¼šæ§åˆ¶å°æ‰“å°å¿«æ·ä¿®æ”¹è¯´æ˜
    console.log('é…ç½®åœ¨ CONF å¯¹è±¡é‡Œï¼šreceiverName, avatar, password, typingLines, musicAutoPlay');
  </script>
</body>
</html>
